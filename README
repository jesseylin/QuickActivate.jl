This code is stolen and lightly rewritten from the DrWatson project. I will add the proper attributions ASAP.
